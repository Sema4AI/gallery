{"metadata": {"name": "Microsoft Email", "description": "Microsoft actions for Email", "secrets": {"/api/actions/microsoft-email/list-messages/run": {"actionPackage": "Microsoft Email", "action": "list_messages", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Mail.Read"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-email/create-draft-message/run": {"actionPackage": "Microsoft Email", "action": "create_draft_message", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Mail.ReadWrite"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-email/add-attachment/run": {"actionPackage": "Microsoft Email", "action": "add_attachment", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Mail.ReadWrite"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-email/send-message/run": {"actionPackage": "Microsoft Email", "action": "send_message", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Mail.Send"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-email/send-draft/run": {"actionPackage": "Microsoft Email", "action": "send_draft", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Mail.Send"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-email/reply-to-message/run": {"actionPackage": "Microsoft Email", "action": "reply_to_message", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Mail.Send"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-email/forward-message/run": {"actionPackage": "Microsoft Email", "action": "forward_message", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Mail.Send"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-email/move-message/run": {"actionPackage": "Microsoft Email", "action": "move_message", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Mail.ReadWrite"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-email/get-message/run": {"actionPackage": "Microsoft Email", "action": "get_message", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Mail.Read"], "description": "OAuth2 token to use for the operation."}}}}, "version": 1}, "openapi.json": {"openapi": "3.1.0", "info": {"title": "Sema4.ai Action Server", "version": "0.16.1"}, "servers": [{"url": "http://localhost:8080"}], "paths": {"/api/actions/microsoft-email/list-messages/run": {"post": {"summary": "List Messages", "description": "List messages in the user's mailbox matching search query.", "operationId": "list_messages", "requestBody": {"content": {"application/json": {"schema": {"properties": {"search_query": {"type": "string", "title": "Search Query", "description": "query to search for messages."}}, "type": "object", "required": ["search_query"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"items": {}, "type": "array"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for List Messages", "description": "Lists of the messages"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-email/create-draft-message/run": {"post": {"summary": "Create Draft Message", "description": "Create a draft message in the user's mailbox.", "operationId": "create_draft_message", "requestBody": {"content": {"application/json": {"schema": {"properties": {"message": {"properties": {"subject": {"type": "string", "title": "Subject", "description": "Subject of the message", "default": ""}, "body": {"type": "string", "title": "Body", "description": "Body of the message", "default": ""}, "to": {"anyOf": [{"items": {"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "Recipient"}, "type": "array"}, {"type": "null"}], "title": "To", "description": "Recipients of the message"}, "cc": {"anyOf": [{"items": {"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "CC_Repient"}, "type": "array"}, {"type": "null"}], "title": "Cc", "description": "CC recipients of the message"}, "bcc": {"anyOf": [{"items": {"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "BCC_Repient"}, "type": "array"}, {"type": "null"}], "title": "Bcc", "description": "BCC recipients of the message"}, "attachments": {"anyOf": [{"items": {"properties": {"message_id": {"type": "string", "title": "Message Id", "description": "Id of the message"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the attachment"}, "content_bytes": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Content Bytes", "description": "Base64-encoded content of the attachment"}, "filepath": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Filepath", "description": "Path to the file to attach"}}, "type": "object", "required": ["message_id"], "title": "MessageAttachment"}, "type": "array"}, {"type": "null"}], "title": "Attachments", "description": "Attachments to include with the message"}, "importance": {"anyOf": [{"type": "string"}, {"type": "null"}], "enum": ["low", "normal", "high"], "title": "Importance", "description": "Importance level of the message", "default": "normal"}, "reply_to": {"anyOf": [{"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "Recipient"}, {"type": "null"}], "description": "Reply-to address"}}, "type": "object", "title": "Message", "description": "The message content to save as a draft."}}, "type": "object", "required": ["message"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Create Draft Message", "description": "The created draft message."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}, "x-openai-isConsequential": true}}, "/api/actions/microsoft-email/add-attachment/run": {"post": {"summary": "Add Attachment", "description": "Add an attachment to a message.\nIf possible pass attachment as local file absolute filepath, or\npass the content_bytes directly.\n\nThe attachment", "operationId": "add_attachment", "requestBody": {"content": {"application/json": {"schema": {"properties": {"attachment": {"properties": {"message_id": {"type": "string", "title": "Message Id", "description": "Id of the message"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the attachment"}, "content_bytes": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Content Bytes", "description": "Base64-encoded content of the attachment"}, "filepath": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Filepath", "description": "Path to the file to attach"}}, "type": "object", "required": ["message_id"], "title": "Attachment", "description": "The attachment to add."}}, "type": "object", "required": ["attachment"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Add Attachment", "description": "The added attachment details."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}, "x-openai-isConsequential": true}}, "/api/actions/microsoft-email/send-message/run": {"post": {"summary": "Send Message", "description": "Send a new message.", "operationId": "send_message", "requestBody": {"content": {"application/json": {"schema": {"properties": {"message": {"properties": {"subject": {"type": "string", "title": "Subject", "description": "Subject of the message", "default": ""}, "body": {"type": "string", "title": "Body", "description": "Body of the message", "default": ""}, "to": {"anyOf": [{"items": {"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "Recipient"}, "type": "array"}, {"type": "null"}], "title": "To", "description": "Recipients of the message"}, "cc": {"anyOf": [{"items": {"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "CC_Repient"}, "type": "array"}, {"type": "null"}], "title": "Cc", "description": "CC recipients of the message"}, "bcc": {"anyOf": [{"items": {"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "BCC_Repient"}, "type": "array"}, {"type": "null"}], "title": "Bcc", "description": "BCC recipients of the message"}, "attachments": {"anyOf": [{"items": {"properties": {"message_id": {"type": "string", "title": "Message Id", "description": "Id of the message"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the attachment"}, "content_bytes": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Content Bytes", "description": "Base64-encoded content of the attachment"}, "filepath": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Filepath", "description": "Path to the file to attach"}}, "type": "object", "required": ["message_id"], "title": "MessageAttachment"}, "type": "array"}, {"type": "null"}], "title": "Attachments", "description": "Attachments to include with the message"}, "importance": {"anyOf": [{"type": "string"}, {"type": "null"}], "enum": ["low", "normal", "high"], "title": "Importance", "description": "Importance level of the message", "default": "normal"}, "reply_to": {"anyOf": [{"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "Recipient"}, {"type": "null"}], "description": "Reply-to address"}}, "type": "object", "title": "Message", "description": "The message content to send."}, "save_to_sent_items": {"type": "boolean", "title": "Save To Sent Items", "description": "Whether to save the message to the sent items.", "default": true}}, "type": "object", "required": ["message"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Send Message", "description": "Response indicating the result of the send operation."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}, "x-openai-isConsequential": true}}, "/api/actions/microsoft-email/send-draft/run": {"post": {"summary": "Send Draft", "description": "Send a draft message.", "operationId": "send_draft", "requestBody": {"content": {"application/json": {"schema": {"properties": {"message_id": {"type": "string", "title": "Message Id", "description": "The ID of the draft message to send."}, "save_to_sent_items": {"type": "boolean", "title": "Save To Sent Items", "description": "Whether to save the message to the sent items.", "default": true}}, "type": "object", "required": ["message_id"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Send Draft", "description": "Response indicating the result of the send operation."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}, "x-openai-isConsequential": true}}, "/api/actions/microsoft-email/reply-to-message/run": {"post": {"summary": "Reply To Message", "description": "Reply to an existing message.", "operationId": "reply_to_message", "requestBody": {"content": {"application/json": {"schema": {"properties": {"message_id": {"type": "string", "title": "Message Id", "description": "The ID of the message to reply to."}, "reply": {"properties": {"subject": {"type": "string", "title": "Subject", "description": "Subject of the message", "default": ""}, "body": {"type": "string", "title": "Body", "description": "Body of the message", "default": ""}, "to": {"anyOf": [{"items": {"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "Recipient"}, "type": "array"}, {"type": "null"}], "title": "To", "description": "Recipients of the message"}, "cc": {"anyOf": [{"items": {"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "CC_Repient"}, "type": "array"}, {"type": "null"}], "title": "Cc", "description": "CC recipients of the message"}, "bcc": {"anyOf": [{"items": {"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "BCC_Repient"}, "type": "array"}, {"type": "null"}], "title": "Bcc", "description": "BCC recipients of the message"}, "attachments": {"anyOf": [{"items": {"properties": {"message_id": {"type": "string", "title": "Message Id", "description": "Id of the message"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the attachment"}, "content_bytes": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Content Bytes", "description": "Base64-encoded content of the attachment"}, "filepath": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Filepath", "description": "Path to the file to attach"}}, "type": "object", "required": ["message_id"], "title": "MessageAttachment"}, "type": "array"}, {"type": "null"}], "title": "Attachments", "description": "Attachments to include with the message"}, "importance": {"anyOf": [{"type": "string"}, {"type": "null"}], "enum": ["low", "normal", "high"], "title": "Importance", "description": "Importance level of the message", "default": "normal"}, "reply_to": {"anyOf": [{"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "Recipient"}, {"type": "null"}], "description": "Reply-to address"}}, "type": "object", "title": "Reply", "description": "The reply message content."}}, "type": "object", "required": ["message_id", "reply"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Reply To Message", "description": "Response indicating the result of the reply operation."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}, "x-openai-isConsequential": true}}, "/api/actions/microsoft-email/forward-message/run": {"post": {"summary": "Forward Message", "description": "Forward an existing message.", "operationId": "forward_message", "requestBody": {"content": {"application/json": {"schema": {"properties": {"message_id": {"type": "string", "title": "Message Id", "description": "The ID of the message to forward."}, "forward": {"properties": {"subject": {"type": "string", "title": "Subject", "description": "Subject of the message", "default": ""}, "body": {"type": "string", "title": "Body", "description": "Body of the message", "default": ""}, "to": {"anyOf": [{"items": {"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "Recipient"}, "type": "array"}, {"type": "null"}], "title": "To", "description": "Recipients of the message"}, "cc": {"anyOf": [{"items": {"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "CC_Repient"}, "type": "array"}, {"type": "null"}], "title": "Cc", "description": "CC recipients of the message"}, "bcc": {"anyOf": [{"items": {"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "BCC_Repient"}, "type": "array"}, {"type": "null"}], "title": "Bcc", "description": "BCC recipients of the message"}, "attachments": {"anyOf": [{"items": {"properties": {"message_id": {"type": "string", "title": "Message Id", "description": "Id of the message"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the attachment"}, "content_bytes": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Content Bytes", "description": "Base64-encoded content of the attachment"}, "filepath": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Filepath", "description": "Path to the file to attach"}}, "type": "object", "required": ["message_id"], "title": "MessageAttachment"}, "type": "array"}, {"type": "null"}], "title": "Attachments", "description": "Attachments to include with the message"}, "importance": {"anyOf": [{"type": "string"}, {"type": "null"}], "enum": ["low", "normal", "high"], "title": "Importance", "description": "Importance level of the message", "default": "normal"}, "reply_to": {"anyOf": [{"properties": {"address": {"type": "string", "title": "Address", "description": "Email address of the recipient"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name", "description": "Name of the recipient"}}, "type": "object", "required": ["address"], "title": "Recipient"}, {"type": "null"}], "description": "Reply-to address"}}, "type": "object", "title": "Forward", "description": "The forward message content."}}, "type": "object", "required": ["message_id", "forward"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Forward Message", "description": "Response indicating the result of the forward operation."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}, "x-openai-isConsequential": true}}, "/api/actions/microsoft-email/move-message/run": {"post": {"summary": "Move Message", "description": "Move a message to a different folder.", "operationId": "move_message", "requestBody": {"content": {"application/json": {"schema": {"properties": {"message_id": {"type": "string", "title": "Message Id", "description": "The ID of the message to move."}, "destination_folder_id": {"type": "string", "title": "Destination Folder Id", "description": "The ID of the destination folder."}}, "type": "object", "required": ["message_id", "destination_folder_id"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Move Message", "description": "The moved message details."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}, "x-openai-isConsequential": true}}, "/api/actions/microsoft-email/get-message/run": {"post": {"summary": "Get Message", "description": "Get the details of a specific message.", "operationId": "get_message", "requestBody": {"content": {"application/json": {"schema": {"properties": {"message_id": {"type": "string", "title": "Message Id", "description": "The ID of the message to retrieve."}}, "type": "object", "required": ["message_id"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Get Message", "description": "The message details."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}}, "components": {"schemas": {"HTTPValidationError": {"properties": {"errors": {"items": {"$ref": "#/components/schemas/ValidationError"}, "type": "array", "title": "Errors"}}, "type": "object", "title": "HTTPValidationError"}, "ValidationError": {"properties": {"loc": {"items": {"anyOf": [{"type": "string"}, {"type": "integer"}]}, "type": "array", "title": "Location"}, "msg": {"type": "string", "title": "Message"}, "type": {"type": "string", "title": "Error Type"}}, "type": "object", "required": ["loc", "msg", "type"], "title": "ValidationError"}}}}}
