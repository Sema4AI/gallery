{"metadata": {"name": "Microsoft Sharepoint", "description": "Microsoft actions for Sharepoint", "secrets": {"/api/actions/microsoft-sharepoint/get-sharepoint-site-id/run": {"actionPackage": "Microsoft Sharepoint", "action": "get_sharepoint_site_id", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Sites.Read.All"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-sharepoint/get-sharepoint-site/run": {"actionPackage": "Microsoft Sharepoint", "action": "get_sharepoint_site", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Sites.Read.All"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-sharepoint/get-all-sharepoint-sites/run": {"actionPackage": "Microsoft Sharepoint", "action": "get_all_sharepoint_sites", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Sites.Read.All"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-sharepoint/download-sharepoint-file/run": {"actionPackage": "Microsoft Sharepoint", "action": "download_sharepoint_file", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Files.Read"], "description": "OAuth2 token to use for the operation"}}}, "/api/actions/microsoft-sharepoint/search-sharepoint-files/run": {"actionPackage": "Microsoft Sharepoint", "action": "search_sharepoint_files", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Files.Read.All"], "description": "OAuth2 token to use for the operation"}}}, "/api/actions/microsoft-sharepoint/upload-file-to-sharepoint/run": {"actionPackage": "Microsoft Sharepoint", "action": "upload_file_to_sharepoint", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Files.ReadWrite"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-sharepoint/get-sharepoint-lists/run": {"actionPackage": "Microsoft Sharepoint", "action": "get_sharepoint_lists", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Sites.Read.All"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-sharepoint/create-sharepoint-list/run": {"actionPackage": "Microsoft Sharepoint", "action": "create_sharepoint_list", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Sites.ReadWrite.All"], "description": "OAuth2 token to use for the operation."}}}}, "version": 1}, "openapi.json": {"openapi": "3.1.0", "info": {"title": "Sema4.ai Action Server", "version": "0.14.0"}, "servers": [{"url": "http://localhost:8080"}], "paths": {"/api/actions/microsoft-sharepoint/get-sharepoint-site-id/run": {"post": {"summary": "Get Sharepoint Site Id", "description": "Get the site id of the Sharepoint site by its name", "operationId": "get_sharepoint_site_id", "requestBody": {"content": {"application/json": {"schema": {"properties": {"site_name": {"type": "string", "title": "Site Name", "description": "name of the Sharepoint site."}}, "type": "object", "required": ["site_name"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Get Sharepoint Site Id", "description": "Site details including the site id or error message"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-sharepoint/get-sharepoint-site/run": {"post": {"summary": "Get Sharepoint Site", "description": "Get the Sharepoint site either by id or by name.", "operationId": "get_sharepoint_site", "requestBody": {"content": {"application/json": {"schema": {"properties": {"site_id": {"type": "string", "title": "Site Id", "description": "id of the Sharepoint site.", "default": ""}, "site_name": {"type": "string", "title": "Site Name", "description": "name of the Sharepoint site.", "default": ""}}, "type": "object"}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Get Sharepoint Site", "description": "Result of the operation"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-sharepoint/get-all-sharepoint-sites/run": {"post": {"summary": "Get All Sharepoint Sites", "description": "Get all Sharepoint sites known to the user.", "operationId": "get_all_sharepoint_sites", "requestBody": {"content": {"application/json": {"schema": {"properties": {}, "type": "object"}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Get All Sharepoint Sites", "description": "Result of the operation"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-sharepoint/download-sharepoint-file/run": {"post": {"summary": "Download Sharepoint File", "description": "Download file(s) from the Sharepoint.", "operationId": "download_sharepoint_file", "requestBody": {"content": {"application/json": {"schema": {"properties": {"filename": {"type": "string", "title": "Filename", "description": "name of the file to download (including the path)"}, "location": {"type": "string", "title": "Location", "description": "\"me\" or \"my files\" or the name of the Sharepoint site or empty to search in all sites", "default": ""}, "target_folder": {"type": "string", "title": "Target Folder", "description": "folder to download the file to", "default": ""}, "download_all_matching": {"type": "boolean", "title": "Download All Matching", "description": "", "default": false}}, "type": "object", "required": ["filename"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"items": {"type": "string"}, "type": "array"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Download Sharepoint File", "description": "List of downloaded files and their locations"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}, "x-openai-isConsequential": false}}, "/api/actions/microsoft-sharepoint/search-sharepoint-files/run": {"post": {"summary": "Search Sharepoint Files", "description": "Search files in the Sharepoint site.", "operationId": "search_sharepoint_files", "requestBody": {"content": {"application/json": {"schema": {"properties": {"search_text": {"type": "string", "title": "Search Text", "description": "text to search for"}, "location": {"type": "string", "title": "Location", "description": "\"me\" or \"my files\" or the id of the Sharepoint site or empty to search in all sites", "default": ""}}, "type": "object", "required": ["search_text"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"properties": {"files": {"items": {"properties": {"location": {"allOf": [{"properties": {"name": {"type": "string", "title": "Name", "description": "Name of the location", "default": ""}, "url": {"type": "string", "title": "Url", "description": "URL of the location", "default": ""}}, "type": "object", "title": "Location"}], "description": "Location details"}, "file": {"type": "object", "title": "File", "description": "File details", "default": {}}}, "type": "object", "required": ["location"], "title": "File"}, "type": "array", "title": "Files", "description": "List of files", "default": []}}, "type": "object", "title": "FileList"}, {"type": "null"}], "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Search Sharepoint Files", "description": "List of files matching the search criteria"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-sharepoint/upload-file-to-sharepoint/run": {"post": {"summary": "Upload File To Sharepoint", "description": "Upload a file to the Sharepoint site.", "operationId": "upload_file_to_sharepoint", "requestBody": {"content": {"application/json": {"schema": {"properties": {"filename": {"type": "string", "title": "Filename", "description": "name of the file."}, "location": {"type": "string", "title": "Location", "description": "\"me\" or \"my files\" or the name of the Sharepoint site.", "default": "me"}}, "type": "object", "required": ["filename"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Upload File To Sharepoint", "description": "Result of the operation"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-sharepoint/get-sharepoint-lists/run": {"post": {"summary": "Get Sharepoint Lists", "description": "Get lists of the Sharepoint site by site id or site name.", "operationId": "get_sharepoint_lists", "requestBody": {"content": {"application/json": {"schema": {"properties": {"site_name": {"type": "string", "title": "Site Name", "description": "name of the Sharepoint site.", "default": ""}, "site_id": {"type": "string", "title": "Site Id", "description": "id of the Sharepoint site.", "default": ""}}, "type": "object"}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Get Sharepoint Lists", "description": "Lists of the Sharepoint site"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-sharepoint/create-sharepoint-list/run": {"post": {"summary": "Create Sharepoint List", "description": "Create list in the Sharepoint site by site id or site name.", "operationId": "create_sharepoint_list", "requestBody": {"content": {"application/json": {"schema": {"properties": {"sharepoint_list": {"properties": {"list_name": {"type": "string", "title": "List Name", "description": "Name of the list", "default": ""}, "columns": {"items": {"properties": {"column_name": {"type": "string", "title": "Column Name", "description": "Name of the column", "default": ""}, "column_type": {"allOf": [{"type": "string", "enum": ["text", "boolean", "dateTime", "number"], "title": "ColumnType"}], "description": "Type of the column", "default": ""}}, "type": "object", "title": "ListColumn"}, "type": "array", "title": "Columns", "description": "List of columns", "default": []}}, "type": "object", "title": "Sharepoint List", "description": "name of the list and columns to create."}, "site_name": {"type": "string", "title": "Site Name", "description": "name of the Sharepoint site.", "default": ""}, "site_id": {"type": "string", "title": "Site Id", "description": "id of the Sharepoint site.", "default": ""}}, "type": "object", "required": ["sharepoint_list"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Create Sharepoint List", "description": "Result of the operation"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}}, "components": {"schemas": {"HTTPValidationError": {"properties": {"errors": {"items": {"$ref": "#/components/schemas/ValidationError"}, "type": "array", "title": "Errors"}}, "type": "object", "title": "HTTPValidationError"}, "ValidationError": {"properties": {"loc": {"items": {"anyOf": [{"type": "string"}, {"type": "integer"}]}, "type": "array", "title": "Location"}, "msg": {"type": "string", "title": "Message"}, "type": {"type": "string", "title": "Error Type"}}, "type": "object", "required": ["loc", "msg", "type"], "title": "ValidationError"}}}}}
