{"metadata": {"name": "Microsoft Teams", "description": "Work with Microsoft Teams.", "secrets": {"/api/actions/microsoft-teams/get-joined-teams/run": {"actionPackage": "Microsoft Teams", "action": "get_joined_teams", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Team.ReadBasic.All"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-teams/search-team-by-name/run": {"actionPackage": "Microsoft Teams", "action": "search_team_by_name", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Group.Read.All"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-teams/get-team-members/run": {"actionPackage": "Microsoft Teams", "action": "get_team_members", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["TeamMember.Read.All"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-teams/get-team-channels/run": {"actionPackage": "Microsoft Teams", "action": "get_team_channels", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Channel.ReadBasic.All"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-teams/search-user/run": {"actionPackage": "Microsoft Teams", "action": "search_user", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["User.Read.All"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-teams/get-channel-messages/run": {"actionPackage": "Microsoft Teams", "action": "get_channel_messages", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["ChannelMessage.Read.All"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-teams/get-message-replies/run": {"actionPackage": "Microsoft Teams", "action": "get_message_replies", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["ChannelMessage.Read.All"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-teams/post-channel-message/run": {"actionPackage": "Microsoft Teams", "action": "post_channel_message", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["ChannelMessage.Send"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-teams/create-team/run": {"actionPackage": "Microsoft Teams", "action": "create_team", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Team.Create", "Group.Read.All"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-teams/create-chat/run": {"actionPackage": "Microsoft Teams", "action": "create_chat", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["Chat.Create"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-teams/send-message-to-chat/run": {"actionPackage": "Microsoft Teams", "action": "send_message_to_chat", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["ChatMessage.Send"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-teams/add-users-to-team/run": {"actionPackage": "Microsoft Teams", "action": "add_users_to_team", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["GroupMember.ReadWrite.All"], "description": "OAuth2 token to use for the operation."}}}, "/api/actions/microsoft-teams/reply-to-message/run": {"actionPackage": "Microsoft Teams", "action": "reply_to_message", "secrets": {"token": {"type": "OAuth2Secret", "provider": "microsoft", "scopes": ["ChannelMessage.Send"], "description": "OAuth2 token to use for the operation."}}}}, "version": 1}, "openapi.json": {"openapi": "3.1.0", "info": {"title": "Sema4.ai Action Server", "version": "0.17.0"}, "servers": [{"url": "http://localhost:8080"}], "paths": {"/api/actions/microsoft-teams/get-joined-teams/run": {"post": {"summary": "Get Joined Teams", "description": "Get all Teams the user is joined to with the full details. Can be used to search Teams as well.", "operationId": "get_joined_teams", "requestBody": {"content": {"application/json": {"schema": {"properties": {}, "type": "object"}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Get Joined Teams", "description": "Result of the operation"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-teams/search-team-by-name/run": {"post": {"summary": "Search Team By Name", "description": "Search for a Microsoft Team by its name.", "operationId": "search_team_by_name", "requestBody": {"content": {"application/json": {"schema": {"properties": {"search_request": {"properties": {"team_name": {"type": "string", "title": "Team Name", "description": "The name of the Microsoft Team to search for."}}, "type": "object", "required": ["team_name"], "title": "Search Request", "description": "Pydantic model containing the team name to search for."}}, "type": "object", "required": ["search_request"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Search Team By Name", "description": "Result of the search operation, including details of matching teams."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-teams/get-team-members/run": {"post": {"summary": "Get Team Members", "description": "Get the members of a specific Microsoft Team.", "operationId": "get_team_members", "requestBody": {"content": {"application/json": {"schema": {"properties": {"team_id": {"type": "string", "title": "Team Id", "description": "The ID of the Microsoft Team."}}, "type": "object", "required": ["team_id"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Get Team Members", "description": "Result of the operation"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-teams/get-team-channels/run": {"post": {"summary": "Get Team Channels", "description": "Get the channels of a specific Microsoft Team.", "operationId": "get_team_channels", "requestBody": {"content": {"application/json": {"schema": {"properties": {"team_id": {"type": "string", "title": "Team Id", "description": "The ID of the Microsoft Team."}}, "type": "object", "required": ["team_id"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Get Team Channels", "description": "Result of the operation"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-teams/search-user/run": {"post": {"summary": "Search User", "description": "Search for a user by email, first name, or last name.", "operationId": "search_user", "requestBody": {"content": {"application/json": {"schema": {"properties": {"user_search": {"properties": {"email": {"anyOf": [{"type": "string", "format": "email"}, {"type": "null"}], "title": "Email", "description": "Email address of the user"}, "first_name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "First Name", "description": "First name of the user"}, "last_name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Last Name", "description": "Last name of the user"}}, "type": "object", "title": "User Search", "description": "The search criteria (email, first name, or last name)."}}, "type": "object", "required": ["user_search"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"items": {"type": "object"}, "type": "array"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Search User", "description": "Result of the operation with user details if found."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-teams/get-channel-messages/run": {"post": {"summary": "Get Channel Messages", "description": "Get messages from a specific channel in a Microsoft Team. Message replies not included but you can use \"get_message_replies\" if needed.", "operationId": "get_channel_messages", "requestBody": {"content": {"application/json": {"schema": {"properties": {"messages_request": {"properties": {"team_id": {"type": "string", "title": "Team Id", "description": "The ID of the Microsoft Team."}, "channel_id": {"type": "string", "title": "Channel Id", "description": "The ID of the channel within the team."}, "limit": {"anyOf": [{"type": "integer"}, {"type": "null"}], "title": "Limit", "description": "The number of messages to retrieve. Defaults to 10.", "default": 10}}, "type": "object", "required": ["team_id", "channel_id"], "title": "Messages Request", "description": "Pydantic model containing the team ID, channel ID, and an optional limit for the number of messages to retrieve."}}, "type": "object", "required": ["messages_request"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Get Channel Messages", "description": "Result of the operation, including a list of parsed messages if successful."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-teams/get-message-replies/run": {"post": {"summary": "Get Message Replies", "description": "Get replies to a specific message in a Microsoft Team channel.", "operationId": "get_message_replies", "requestBody": {"content": {"application/json": {"schema": {"properties": {"replies_request": {"properties": {"team_id": {"type": "string", "title": "Team Id", "description": "The ID of the Microsoft Team."}, "channel_id": {"type": "string", "title": "Channel Id", "description": "The ID of the channel within the team."}, "message_id": {"type": "string", "title": "Message Id", "description": "The ID of the message to get replies for."}}, "type": "object", "required": ["team_id", "channel_id", "message_id"], "title": "Replies Request", "description": "Pydantic model containing the team ID, channel ID, and message ID."}}, "type": "object", "required": ["replies_request"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Get Message Replies", "description": "Result of the operation, including a list of parsed replies if successful."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-teams/post-channel-message/run": {"post": {"summary": "Post Channel Message", "description": "Post a message to a specific channel in a Microsoft Team. If multiple channels ask user which to use.", "operationId": "post_channel_message", "requestBody": {"content": {"application/json": {"schema": {"properties": {"message_request": {"properties": {"team_id": {"type": "string", "title": "Team Id", "description": "The ID of the Microsoft Team."}, "channel_id": {"type": "string", "title": "Channel Id", "description": "The ID of the channel within the team."}, "message": {"type": "string", "title": "Message", "description": "The message to post."}}, "type": "object", "required": ["team_id", "channel_id", "message"], "title": "Message Request", "description": "Pydantic model containing team_id, channel_id, and message."}}, "type": "object", "required": ["message_request"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Post Channel Message", "description": "Result of the operation"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-teams/create-team/run": {"post": {"summary": "Create Team", "description": "Create a new Microsoft Team using the standard template.", "operationId": "create_team", "requestBody": {"content": {"application/json": {"schema": {"properties": {"team_details": {"properties": {"display_name": {"type": "string", "title": "Display Name", "description": "Display name of the team"}, "description": {"type": "string", "title": "Description", "description": "Description of the team"}, "visibility": {"type": "string", "title": "Visibility", "description": "Visibility of the team (public/private)", "default": "private"}}, "type": "object", "required": ["display_name", "description"], "title": "Team Details", "description": "Details of the team to be created."}}, "type": "object", "required": ["team_details"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Create Team", "description": "Result of the operation, including the details of the newly created team."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-teams/create-chat/run": {"post": {"summary": "Create Chat", "description": "Create a new chat (one-on-one or group) based on the number of recipients.", "operationId": "create_chat", "requestBody": {"content": {"application/json": {"schema": {"properties": {"chat_request": {"properties": {"recipient_ids": {"items": {"type": "string"}, "type": "array", "title": "Recipient Ids", "description": "List of recipient user IDs for the chat."}}, "type": "object", "required": ["recipient_ids"], "title": "Chat Request", "description": "Pydantic model containing a list of recipient IDs."}}, "type": "object", "required": ["chat_request"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Create Chat", "description": "Result of the operation, including chat details if successful."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-teams/send-message-to-chat/run": {"post": {"summary": "Send Message To Chat", "description": "Send a message to a specific chat which needs to be created first.", "operationId": "send_message_to_chat", "requestBody": {"content": {"application/json": {"schema": {"properties": {"message_request": {"properties": {"chat_id": {"type": "string", "title": "Chat Id", "description": "The ID of the chat to send the message to."}, "message": {"type": "string", "title": "Message", "description": "The message content to send."}}, "type": "object", "required": ["chat_id", "message"], "title": "Message Request", "description": "Pydantic model containing the chat ID and message content."}}, "type": "object", "required": ["message_request"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Send Message To Chat", "description": "Result of the operation, including message details if successful."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-teams/add-users-to-team/run": {"post": {"summary": "Add Users To Team", "description": "Add one or more users to a Microsoft Team.", "operationId": "add_users_to_team", "requestBody": {"content": {"application/json": {"schema": {"properties": {"add_users_request": {"properties": {"team_id": {"type": "string", "title": "Team Id", "description": "The ID of the Microsoft Team."}, "user_ids": {"items": {"type": "string"}, "type": "array", "title": "User Ids", "description": "List of user IDs to add to the team."}}, "type": "object", "required": ["team_id", "user_ids"], "title": "Add Users Request", "description": "Pydantic model containing the team ID and list of user IDs."}}, "type": "object", "required": ["add_users_request"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Add Users To Team", "description": "Result of the operation, including details if successful."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/api/actions/microsoft-teams/reply-to-message/run": {"post": {"summary": "Reply To Message", "description": "Reply to a specific message in a Microsoft Team channel.", "operationId": "reply_to_message", "requestBody": {"content": {"application/json": {"schema": {"properties": {"reply_request": {"properties": {"team_id": {"type": "string", "title": "Team Id", "description": "The ID of the Microsoft Team."}, "channel_id": {"type": "string", "title": "Channel Id", "description": "The ID of the channel within the team."}, "message_id": {"type": "string", "title": "Message Id", "description": "The ID of the message to reply to."}, "reply": {"type": "string", "title": "Reply", "description": "The content of the reply message."}}, "type": "object", "required": ["team_id", "channel_id", "message_id", "reply"], "title": "Reply Request", "description": "Pydantic model containing team_id, channel_id, message_id, and the reply content."}}, "type": "object", "required": ["reply_request"]}}}, "required": true}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"properties": {"result": {"anyOf": [{"type": "object"}, {"type": "null"}], "title": "Result", "description": "The result for the action if it ran successfully"}, "error": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Error", "description": "The error message if the action failed for some reason"}}, "type": "object", "title": "Response for Reply To Message", "description": "Result of the operation."}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}}, "components": {"schemas": {"HTTPValidationError": {"properties": {"errors": {"items": {"$ref": "#/components/schemas/ValidationError"}, "type": "array", "title": "Errors"}}, "type": "object", "title": "HTTPValidationError"}, "ValidationError": {"properties": {"loc": {"items": {"anyOf": [{"type": "string"}, {"type": "integer"}]}, "type": "array", "title": "Location"}, "msg": {"type": "string", "title": "Message"}, "type": {"type": "string", "title": "Error Type"}}, "type": "object", "required": ["loc", "msg", "type"], "title": "ValidationError"}}}}}
